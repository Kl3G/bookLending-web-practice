# アプリ概要

このアプリは、図書管理を行う CLI アプリケーションです。  
図書の貸出、返却、登録、検索、削除、ならびに貸出履歴の参照機能を提供します。

---

# 設計構造と意図

参考：  
- https://blog.cleancoder.com/  
- 『Agile Software Development』（2002/2003）

Domain 概念を基盤として定義される一つのルール（要求）を、  
概念、流れ、detail（技術的要素）に分離する  
Clean Architecture の理解を目的として、  
図書管理アプリを設計しました。

---

## 1. Entity の分離

図書（Book）と貸出（Loan）を Entity として分離しました。  
貸出可否のようなルールが複数箇所で重複実装されたり、  
DB や UI 側で恣意的に判断されることを防ぐためです。

---

## 2. Use Case の分離

各ルールの手順（業務フロー）を Use Case として分離・構造化（固定）し、  
手順が揺らがないようにするとともに、  
変更（特に UI 変更）による影響を最小限に抑えました。

---

## 3. Interface の導入

DB などの外部環境の変化がドメインに影響を与えないよう、  
Interface を使用しました。  
これにより、DB 実装の差し替えや  
メソッドシグネチャの変更が  
Use Case に与える影響を最小化しました。

---

## 4. Presenter の役割

Presenter を使用することで、  
出力（UI）が Entity の内部構造やルールを  
再解釈・再構成することを防ぎました。

---

# 問題点

Gateway が過剰な責務を持っています。  
図書の登録・返却だけでなく、  
他の機能の責務まで Gateway に集中しています。

この構造は、変更が発生した際に  
Gateway が常に修正対象の候補となる問題を生みます。

また、index.php も責務が多すぎるため、  
今後は Controller の概念を理解したうえで、  
適用すべきだと判断しました。

---

# つまずいたところ

この一か月は、機能を実装したり  
正常動作を確認したりすることではなく、  
将来の変更を見据えて、

- なぜこのコードがここにあるべきなのか  
- なぜここに置いてはいけないのか  

を、初めて深く考えた時間でした。

アーキテクチャという概念自体が抽象的で、  
提示される例も仮定に基づくものが多く、  
理解するのは容易ではありませんでしたが、  
同時に非常に面白い経験でもありました。

---

# 今後について

良いアーキテクチャは  
変更の影響を最小化するものですが、  
将来のすべての変更を  
事前に予測することは不可能であり、  
その価値は実際に変更が発生するまで  
体感しにくいと言われています。

今後もこの学習を継続し、  
深い理解を基にアプリを丈夫に設計し、  
実際に変更が発生した際に、  
その判断が正しかったかを体感しながら  
経験を積んでいきたいと考えています。
